# go-appsensor

Learning how to implement owasp-appsensor in go.


## Motivation

Create a detector/response unit for identifying malicious attempts and taking action against them.

## Detection

Detection can be as simple as logging the user's identifier (IP address, browser fingerprinting, session id, user id .etc). There should be a count for each request patterns that are detected too. For each attempt, the count should be incremented, and once the threshold has been exceeded, the user would be block from accessing the service. Custom rules can be set there, for example blocking the user for 1hr, or permanently disabling the account. To unblock the user, custom rules can also be applied, such as resetting the count after 1 day, or decrement it hourly. Some examples of the rules are:

- for every attempts, increment linearly
- for every attempts, increment exponentially
- once hit threshold, block
- once block, decrement linearly per hour
- once block, will reset if operators decide to whitelist user

## Request Patterns

Some generic request patters are:

- invalid request
- rate-limit exceeded
- unauthorized 

It can also be specific to the business logic:

- invalid logging attempts for 3 times

## Response Action

- block IP
- block user (blacklist/whitelist)
- alert operation staff

## Observability

- Generate report
- Produce statistics
- Detect patterns/trends
- Searchable request context (based on context logging)
- Flow of attack

## Chaos Testing

In order to test the effectiveness of the system, it is always good to test it by automating the attacks. There could be a bot that are generating random requests to the system with random payloads (e.g. those generated by faker, or _quickcheck_. Since the IP is known, we can identify other patterns that are not encountered during testing.
